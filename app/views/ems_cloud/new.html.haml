- url = @ems.persisted? ? ems_clouds_path(@ems) : ems_clouds_path
= form_for(@ems,
           :url    => url,
           :method => :post,
           :html   => {"ng-controller"   => "emsCommonFormController",
                       "name"            => "angularForm",
                       "ng-show"         => "afterGet",
                       "create-url"      => "#{url}",
                       "form-fields-url" => "/#{controller_name}/ems_cloud_form_fields/",
                       "novalidate"      => true}) do |f|
  %input{:type => 'hidden', :id => "form_id", :value => "##{f.options[:html][:id]}"}
  -#%input{:type => 'hidden', :id => "button_name", :name => "button", :value => "add"}
  %input{:type => 'hidden', :id => "cred_type", :name => "cred_type", :value => "default"}
  -#= render :partial => "shared/views/ems_common/angular/form"

%ems-edit-cloud-form{'new-record'                     => true,
                     'cloud-fields-url'               => "/#{controller_name}/ems_cloud_form_fields/",
                     'create-cloud-url'               => "#{url}",
                     'ems-common-form-id'             => "#{@ems.id}",
                     'ems-type-options'               => "#{@ems_types}",
                     'provider-regions'               => "#{@provider_regions.keys.to_json}",
                     'provider-regions-options'       => @provider_regions.to_json,
                     'api-version-options'            => "#{@openstack_api_versions}",
                     'nuage-api-version-options'      => "#{@nuage_api_versions}",
                     'ems-infra-provider-id-options'  => @openstack_infra_providers.sort_by { |name, _name| name },
                     'ems-zone-options'               => @server_zones.sort_by { |name, _name| name },
                     'openstack-security-protocols'   => @openstack_security_protocols,
                     'ampq-security-protocols'        => @amqp_security_protocols}

:javascript
  ManageIQ.angular.app.value('emsCommonFormId', '#{@ems.id || "new"}');
  ManageIQ.angular.app.value('providerRegionOptions', #{@provider_regions.to_json})
  miq_bootstrap($('#form_id').val());
  miq_bootstrap('ems-edit-cloud-form');
