- if @record
  #accordion.panel-group
    = miq_accordion_panel(truncate(@record.name, :length => truncate_length), true, "icon") do
      = render :partial => 'shared/quadicon', :locals => {:record => @record}

      %div{:style => "text-align:center"}
        - unless @record.vmm_product.nil?
          = h(@record.vmm_product)
        - unless @record.vmm_version.nil?
          &nbsp;
          = h(@record.vmm_version)
        - unless @record.vmm_buildnumber.nil?
          %br
          = h(@record.vmm_buildnumber)

    = miq_accordion_panel(_("Properties"), false, "host_prop") do
      %ul.nav.nav-pills.nav-stacked
        %li
          = link_to(_('Summary'),
            {:action => 'show', :id => @record, :display => 'main'},
            :title => _("Show Summary"))
        - devices, os_info, vmm_info = host_info
        = li_link(:if => !(devices.nil? || devices.empty?),
          :text       => _('Devices'),
          :record_id  => @record.id,
          :display    => 'devices',
          :title      => _("Show Host devices"))
        = li_link(:count => @record.number_of(:switches),
          :text          => _('Network'),
          :record_id     => @record.id,
          :display       => 'network',
          :title         => _("Show Host network"))
        = li_link(:if => !(@record.hardware.blank? || @record.hardware.number_of(:storage_adapters) == 0),
          :text       => _('Storage Adapters'),
          :record_id  => @record.id,
          :display    => 'storage_adapters',
          :title      => _("Show Host storage adapters"))
        = li_link(:if => !(os_info.nil? || os_info.empty?),
          :text       => _('OS Information'),
          :record_id  => @record.id,
          :display    => 'os_info',
          :title      => _("Show Host OS information"))
        = li_link(:if => !(vmm_info.nil? || vmm_info.empty?),
          :text       => _('VMM Information'),
          :record_id  => @record.id,
          :display    => 'hv_info',
          :title      => _("Show VMM information"))
        = li_link(:if => @record.has_perf_data?,
          :text       => _('Capacity & Utilization'),
          :record_id  => @record.id,
          :display    => 'performance',
          :title      => _("Show Capacity & Utilization"))
        = li_link(:if => @record.has_events? || @record.has_events?(:policy_events),
          :text       => _('Timelines'),
          :display    => 'timeline',
          :record_id  => @record.id,
          :title      => _("Show Timelines"))
        - if ::Settings.product.proto
          = li_link(:count => @record.event_logs.count,
            :text          => _("ESX Logs"),
            :id            => @record.id,
            :title         => _("Show esx logs on this VM"))

    = miq_accordion_panel(_("Relationships"), false, "host_rel") do
      %ul.nav.nav-pills.nav-stacked
        - if role_allows?(:feature => "ems_infra_show") && !@record.ext_management_system.nil?
          %li
            = link_to(_("Infrastructure Provider: %{name}") % {:name => @record.ext_management_system.name},
              ems_infra_path(@record.ext_management_system),
              :title => _("Show parent Infrastructure Provider for this Host"))

        - if role_allows?(:feature => "ems_cluster_show") && !@record.ems_cluster.nil?
          %li
            = link_to(_("Cluster: %{name}") % {:name => @record.ems_cluster.name},
              {:controller => "ems_cluster", :action => 'show', :id => @record.ems_cluster.id.to_s},
              :title => _("Show parent Cluster for this Host"))

        - if role_allows?(:feature => "ems_cluster_show") && @record.ems_cluster.nil?
          = li_link(:if => false, :text => _("Cluster: None"))

        - if role_allows?(:feature => "storage_show_list")
          = li_link(:count => @record.number_of(:storages),
            :record_id     => @record.id,
            :tables        => 'storages',
            :display       => 'storages',
            :action        => 'show')

        - if role_allows?(:feature => "resource_pool_show_list")
          = li_link(:count => @record.number_of(:resource_pools),
            :text          => _("Resource Pools"),
            :record_id     => @record.id,
            :display       => 'resource_pools',
            :title         => _("Show Resource Pools"))

        - if role_allows?(:feature => "vm_show_list")
          = li_link(:count => @record.number_of(:vms),
            :text          => _("VMs"),
            :record_id     => @record.id,
            :display       => 'vms',
            :title         => _("Show all VMs"))

        - if role_allows?(:feature => "miq_template_show_list")
          = li_link(:count => @record.number_of(:miq_templates),
            :text          => _("Templates"),
            :record_id     => @record.id,
            :display       => 'miq_templates',
            :title         => _("Show all Templates"))

        - if role_allows?(:feature => "host_drift")
          = li_link(:count => @record.number_of(:drift_states),
            :text          => _("Drift History"),
            :action        => 'drift_history',
            :record_id     => @record.id,
            :title         => _("Show Host drift history"))

        - if role_allows?(:feature => "physical_server_show") && !@record.physical_server.nil?
          %li
            - physical_server_show = {:controller => "physical_server", :action => 'show', :id => @record.physical_server.id}
            = link_to(_("Physical Server: %{name}") % {:name => @record.physical_server.name},
              physical_server_show,
              :title => _("Show Physical Server"))

        - if role_allows?(:feature => "physical_server_show") && @record.physical_server.nil?
          = li_link(:if => false, :text => _("Physical Server: None"))

    = miq_accordion_panel(_("Security"), false, "host_sec") do
      %ul.nav.nav-pills.nav-stacked
        = li_link(:count => @record.number_of(:users),
          :text          => _("Users"),
          :action        => "users",
          :record_id     => @record.id,
          :db            => "host",
          :title         => _("Show the users defined on this Host"))
        = li_link(:count => @record.number_of(:groups),
          :text          => _("Groups"),
          :action        => "groups",
          :record_id     => @record.id,
          :db            => "host",
          :title         => _("Show the groups defined on this Host"))

        = li_link(:count => @record.number_of(:patches),
          :text          => _("Patches"),
          :action        => "patches",
          :record_id     => @record.id,
          :db            => "host",
          :title         => _("Show the patches installed on this Host"))
        = li_link(:count => @record.number_of(:firewall_rules),
          :text          => _("Firewall Rules"),
          :action        => 'firewall_rules',
          :record_id     => @record.id,
          :title         => _("Show the firewall rules on this Host"))

    = miq_accordion_panel(_("Configuration"), false, "host_config") do
      %ul.nav.nav-pills.nav-stacked
        = li_link(:count => @record.number_of(:guest_applications),
          :text          => _("Packages"),
          :action        => 'guest_applications',
          :record_id     => @record.id,
          :title         => _("Show the packages installed on this Host"))
        = li_link(:count => @record.number_of(:host_services),
          :text          => _("Services"),
          :action        => 'host_services',
          :record_id     => @record.id,
          :title         => _("Show the services installed on this Host"))
        = li_link(:count => @record.number_of(:filesystems),
          :text          => _("Files"),
          :action        => 'filesystems',
          :record_id     => @record.id,
          :title         => _("Show the files on this Host"))
        = li_link(:count => @record.number_of(:advanced_settings),
          :text          => _("Advanced Settings"),
          :action        => 'advanced_settings',
          :record_id     => @record.id,
          :title         => _("Show the advanced settings on this Host"))
