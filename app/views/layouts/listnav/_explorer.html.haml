- if @accords
  #accordion.panel-group{'ng-controller' => 'treeViewController as vm'}
    -# Set the first accordion as selected if there is no active_accord in the sandbox
    - selected = @accords.find(-> { @accords.first }) { |accord| accord[:name].to_sym == @sb[:active_accord] }
    - @accords.each do |accord|
      = miq_accordion_panel(accord[:title], selected == accord, accord[:container]) do
        -# Set the first tree to be rendered if there is a mismatch with the name/type
        - tree = @trees.find(-> { @trees.first }) { |t| t.type == accord[:name].to_sym  }
        %miq-tree-view{:name       => tree.name,
                       :data       => tree.locals_for_render[:bs_tree],
                       "ng-init"   => "vm.initSelected('#{tree.name}', '#{tree.locals_for_render[:select_node]}')",
                       'on-select' => "vm.nodeSelect(node, '/#{request.parameters[:controller]}/tree_select')",
                       'selected'  => "vm.selectedNodes['#{tree.name}']",
                       'lazy-load' => "(vm.lazyLoad(node, '#{tree.name}', '/#{request.parameters[:controller]}/tree_autoload'))"}
  :javascript
    miq_bootstrap('#accordion', 'ManageIQ.treeView');
    $('#accordion').on('show.bs.collapse', miqAccordSelect);
