= render :partial => "layouts/flash_msg"
- if @edit
  - url = url_for_only_path(:action => 'rbac_role_field_changed', :id => (@edit[:role_id] || "new"))
  #role_info
  .row
    .col-md-12.col-lg-6
      %h3
        = _("Role Information")
      .form-horizontal
        .form-group
          %label.col-md-4.control-label
            = _("Name")
          .col-md-8
            = text_field_tag("name",
                               @edit[:new][:name],
                               :maxlength => 50,
                               :class => "form-control",
                               "data-miq_observe" => {:interval => '.5', :url => url}.to_json)
            = javascript_tag(javascript_focus('name'))
        .form-group
          %label.col-md-4.control-label
            = _('Access Restriction for Catalog Items')
          .col-md-8
            - restrictions = MiqUserRole::RESTRICTIONS.map { |k, v| [_(v), k] }.sort_by { |name, _value| name.downcase }
            = select_tag('service_template_restriction',
                          options_for_select([[_("None"), "none"]] + restrictions,
                          @edit[:new][:service_template_restriction].to_sym),
                          :class => "selectpicker")
          :javascript
            miqInitSelectPicker();
            miqSelectPickerEvent('service_template_restriction', "#{url}")
        .form-group
          %label.col-md-4.control-label
            = _('Access Restriction for Key Pairs')
          .col-md-8
            - restrictions = MiqUserRole::RESTRICTIONS.map { |k, v| [_(v), k] }.sort_by { |name, _value| name.downcase }
            = select_tag('auth_key_pair_restriction',
                          options_for_select([[_("None"), "none"]] + restrictions,
                          @edit[:new][:auth_key_pair_restriction].to_sym),
                          :class => "selectpicker")
          :javascript
            miqInitSelectPicker();
            miqSelectPickerEvent('auth_key_pair_restriction', "#{url}")
        .form-group
          %label.col-md-4.control-label
            = _('Access Restriction for Orchestration Stacks')
          .col-md-8
            - restrictions = MiqUserRole::RESTRICTIONS.map { |k, v| [_(v), k] }.sort_by { |name, _value| name.downcase }
            = select_tag('orchestration_stack_restriction',
                          options_for_select([[_("None"), "none"]] + restrictions,
                          @edit[:new][:orchestration_stack_restriction].to_sym),
                          :class => "selectpicker")
          :javascript
            miqInitSelectPicker();
            miqSelectPickerEvent('orchestration_stack_restriction', "#{url}")
        .form-group
          %label.col-md-4.control-label
            = _('Access Restriction for Services')
          .col-md-8
            - restrictions = MiqUserRole::RESTRICTIONS.map { |k, v| [_(v), k] }.sort_by { |name, _value| name.downcase }
            = select_tag('service_restriction',
                          options_for_select([[_("None"), "none"]] + restrictions,
                          @edit[:new][:service_restriction].to_sym),
                          :class => "selectpicker")
          :javascript
            miqInitSelectPicker();
            miqSelectPickerEvent('service_restriction', "#{url}")
        .form-group
          %label.col-md-4.control-label
            = _('Access Restriction for VMs and Templates')
          .col-md-8
            - restrictions = MiqUserRole::RESTRICTIONS.map { |k, v| [_(v), k] }.sort_by { |name, _value| name.downcase }
            = select_tag('vm_restriction',
                          options_for_select([[_("None"), "none"]] + restrictions,
                          @edit[:new][:vm_restriction].to_sym),
                          :class => "selectpicker")
          :javascript
            miqInitSelectPicker();
            miqSelectPickerEvent('vm_restriction', "#{url}")
    .col-md-12.col-lg-6
      %hr
        = _("Product Features (Editing)")
      %h3
      = render(:partial => "shared/tree", :locals => {:tree => @rbac_menu_tree, :name => @rbac_menu_tree.name})
- else
  = role_rbac_details(@role, @rbac_menu_tree)
